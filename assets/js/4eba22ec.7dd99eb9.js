"use strict";(self.webpackChunkquiri_docs=self.webpackChunkquiri_docs||[]).push([[9915],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=r.createContext({}),m=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=m(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=m(n),d=i,h=u["".concat(l,".").concat(d)]||u[d]||p[d]||a;return n?r.createElement(h,o(o({ref:t},c),{},{components:n})):r.createElement(h,o({ref:t},c))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var m=2;m<a;m++)o[m]=n[m];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},5216:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return m},toc:function(){return p}});var r=n(7462),i=n(3366),a=(n(7294),n(3905)),o=["components"],s={},l="Room Invites",m={unversionedId:"Understanding Matrix and the Dart Matrix SDK/room-invites",id:"Understanding Matrix and the Dart Matrix SDK/room-invites",title:"Room Invites",description:"- I had to specify RoomMember events as ImportantEvents in the client initialization",source:"@site/docs/Understanding Matrix and the Dart Matrix SDK/room-invites.md",sourceDirName:"Understanding Matrix and the Dart Matrix SDK",slug:"/Understanding Matrix and the Dart Matrix SDK/room-invites",permalink:"/quiri-docs/Understanding Matrix and the Dart Matrix SDK/room-invites",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Registering New Users",permalink:"/quiri-docs/Understanding Matrix and the Dart Matrix SDK/registering-new-users"},next:{title:"Starting and Restarting Sessions",permalink:"/quiri-docs/Understanding Matrix and the Dart Matrix SDK/starting-and-restarting-sessions"}},c={},p=[],u={toc:p};function d(e){var t=e.components,n=(0,i.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"room-invites"},"Room Invites"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"I had to specify RoomMember events as ",(0,a.kt)("inlineCode",{parentName:"p"},"ImportantEvents")," in the client initialization"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"I think that ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/famedly/matrix-dart-sdk/blob/defe47a1988434b0b9c2f2cae08919e52dcd760f/lib/src/client.dart#L3046-L3049"},"the server is still sending all the data but we are just not loading them into the DB?")),(0,a.kt)("li",{parentName:"ul"},"what advantage is there to that?"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/famedly/matrix-dart-sdk/blob/defe47a1988434b0b9c2f2cae08919e52dcd760f/lib/src/client.dart#L161-L173"},"here are the notes on why (performance?) they do this filtering and when the data will be loaded (on timeline or a call to ",(0,a.kt)("inlineCode",{parentName:"a"},"postload"),")")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"And I set lazyloading to false in the filter"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://spec.matrix.org/latest/client-server-api/#lazy-loading-room-members"},"lazyLoading docs")),(0,a.kt)("li",{parentName:"ul"},"the filter is serverside so it can make sense to not load all of the room member events to save on bandwidth"),(0,a.kt)("li",{parentName:"ul"},"tested toggling lazy loading filter and it only disincludes the room summaries so it is not the thing keeping"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://spec.matrix.org/latest/client-server-api/#mroommember"},"m.room.member event type docs"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://spec.matrix.org/latest/client-server-api/#get_matrixclientv3sync"},"/sync request docs"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://spec.matrix.org/latest/client-server-api/#post_matrixclientv3createroom"},"/createRoom (what happens when you create a room)"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://spec.matrix.org/latest/client-server-api/#room-membership"},"types of room membership and how to change them")))),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"question is, when it comes to knowing who invited you to a room, is the user's member room state the source of truth? Looks like it"),(0,a.kt)("li",{parentName:"ul"},"here are all of the basic events in a room that was created and then invited another user:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'"invite": {\n    "!UIayZfmTbMXGXJWATK:quiri.io": {\n        "invite_state": {\n            "events": [\n                {\n                    "type": "m.room.join_rules",\n                    "state_key": "",\n                    "content": {\n                        "join_rule": "invite"\n                    },\n                    "sender": "@loisel:quiri.io"\n                },\n                {\n                    "type": "m.room.create",\n                    "state_key": "",\n                    "content": {\n                        "room_version": "10",\n                        "creator": "@loisel:quiri.io"\n                    },\n                    "sender": "@loisel:quiri.io"\n                },\n                {\n                    "type": "m.room.member",\n                    "state_key": "@loisel:quiri.io",\n                    "content": {\n                        "displayname": "Loisel",\n                        "avatar_url": "MjAyNS0wNC0xOFQyMzoyODo1OS41OTIyMTU=",\n                        "membership": "join"\n                    },\n                    "sender": "@loisel:quiri.io"\n                },\n                {\n                    "type": "m.room.member",\n                    "sender": "@loisel:quiri.io",\n                    "content": {\n                        "is_direct": true,\n                        "displayname": "nigel",\n                        "membership": "invite"\n                    },\n                    "state_key": "@nigel:quiri.io",\n                    "origin_server_ts": 1745086563571,\n                    "unsigned": {\n                        "age": 206359996\n                    },\n                    "event_id": "$HPuKYzqWnCj2s6uYBuhETH97HjTT1a8XgGXHuW1J28o"\n                }\n            ]\n        }\n    }\n}\n')),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"only room.create is included in the default state from which you can know who created the room but if you want to know specifically who invited you it seems that you need to inspect the room.member event")))}d.isMDXComponent=!0}}]);