"use strict";(self.webpackChunkquiri_docs=self.webpackChunkquiri_docs||[]).push([[1807],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=i.createContext({}),s=function(e){var t=i.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=s(e.components);return i.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=r,f=d["".concat(c,".").concat(m)]||d[m]||p[m]||o;return n?i.createElement(f,a(a({ref:t},u),{},{components:n})):i.createElement(f,a({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,a=new Array(o);a[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:r,a[1]=l;for(var s=2;s<o;s++)a[s]=n[s];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1664:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return c},default:function(){return m},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return p}});var i=n(7462),r=n(3366),o=(n(7294),n(3905)),a=["components"],l={slug:"sending-and-accepting-room-invites",title:"Sending and Accepting Room Invites",authors:["nigel"],tags:["quiri","guide"]},c="DRAFT",s={permalink:"/quiri-docs/blog/sending-and-accepting-room-invites",source:"@site/blog/2024-12-19-sending-and-accepting-room-invites.md",title:"Sending and Accepting Room Invites",description:"Background",date:"2024-12-19T00:00:00.000Z",formattedDate:"December 19, 2024",tags:[{label:"quiri",permalink:"/quiri-docs/blog/tags/quiri"},{label:"guide",permalink:"/quiri-docs/blog/tags/guide"}],readingTime:1.045,truncated:!1,authors:[{name:"Nigel Maynard",title:"Quiri Founder",url:"https://github.com/nigel-smk",imageURL:"https://github.com/nigel-smk.png",key:"nigel"}],frontMatter:{slug:"sending-and-accepting-room-invites",title:"Sending and Accepting Room Invites",authors:["nigel"],tags:["quiri","guide"]},prevItem:{title:"Listening for New Messages With the Matrix SDK",permalink:"/quiri-docs/blog/listening-for-new-messages-with-the-matrix-sdk"},nextItem:{title:"Opening a Quiri with Another User",permalink:"/quiri-docs/blog/opening-a-quiri-with-another-user"}},u={authorsImageUrls:[void 0]},p=[{value:"Background",id:"background",level:2},{value:"Accepting an Invite",id:"accepting-an-invite",level:2},{value:"Listening for Invites",id:"listening-for-invites",level:2}],d={toc:p};function m(e){var t=e.components,n=(0,r.Z)(e,a);return(0,o.kt)("wrapper",(0,i.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"background"},"Background"),(0,o.kt)("p",null,"Inviting someone to a Quiri is a core experience in the quiri app. This guide studies the matrix invite functionality as well as how the Dart SDK implements it (with references to how Fluffychat does it.) See ",(0,o.kt)("a",{parentName:"p",href:"/quiri-docs/blog/opening-a-quiri-with-another-user"},"User Discovery in Quiri")," for a discussion of user discoverability and maintaining a contact list."),(0,o.kt)("h2",{id:"accepting-an-invite"},"Accepting an Invite"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://gitlab.com/famedly/fluffychat/-/blob/9ad85504493198439673ef5d8e31375ddb2af051/lib/pages/chat_list/chat_list_item.dart#L39-52"},"Lets see how Fluffychat does it."),"\nIt appears that when you are invited to a room, you will be added to the room but with a membership status of ",(0,o.kt)("inlineCode",{parentName:"p"},"invite"),". The SDK calls the ",(0,o.kt)("a",{parentName:"p",href:"https://playground.matrix.org/#post-/_matrix/client/v3/join/-roomIdOrAlias-"},"join room endpoint"),". Fluffychat is then SDK's ",(0,o.kt)("inlineCode",{parentName:"p"},"client.waitForRoomInSync")," method to wait for that room to be ",(0,o.kt)("inlineCode",{parentName:"p"},"enabled")," after the room join event is added to the event graph."),(0,o.kt)("p",null,"TODO:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"how do you list rooms that you have been invited to?")),(0,o.kt)("h2",{id:"listening-for-invites"},"Listening for Invites"),(0,o.kt)("p",null,"The SDK offers the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/famedly/matrix-dart-sdk/blob/501c457ea130481ba5b52d45d4d0ff37b8707964/lib/src/client.dart#L822-L844"},"waitForRoomInSync method")," that waits for a specific room by ID to experience an ",(0,o.kt)("inlineCode",{parentName:"p"},"invite"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"join")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"leave")," event. For private rooms I don't imagine that you would know the id of the room to be able to listen for it in this way. I haven't figured out how Fluffychat handles room invites but based on the ",(0,o.kt)("inlineCode",{parentName:"p"},"waitForRoomInSync")," method I am watching the ",(0,o.kt)("inlineCode",{parentName:"p"},"onSync")," stream, filtering on room events."))}m.isMDXComponent=!0}}]);