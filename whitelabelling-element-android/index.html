<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-whitelabelling-element-android">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="alternate" type="application/rss+xml" href="/quiri-docs/blog/rss.xml" title="Quiri Docs and Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/quiri-docs/blog/atom.xml" title="Quiri Docs and Blog Atom Feed"><title data-rh="true">Whitelabelling Element Android | Quiri Docs and Blog</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://quiri-io.github.io/quiri-docs/whitelabelling-element-android"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Whitelabelling Element Android | Quiri Docs and Blog"><meta data-rh="true" name="description" content="- Forking allows for easier contributing back to element should that ever happen…"><meta data-rh="true" property="og:description" content="- Forking allows for easier contributing back to element should that ever happen…"><link data-rh="true" rel="icon" href="/quiri-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://quiri-io.github.io/quiri-docs/whitelabelling-element-android"><link data-rh="true" rel="alternate" href="https://quiri-io.github.io/quiri-docs/whitelabelling-element-android" hreflang="en"><link data-rh="true" rel="alternate" href="https://quiri-io.github.io/quiri-docs/whitelabelling-element-android" hreflang="x-default"><link rel="stylesheet" href="/quiri-docs/assets/css/styles.e9529800.css">
<link rel="preload" href="/quiri-docs/assets/js/runtime~main.10bef9fe.js" as="script">
<link rel="preload" href="/quiri-docs/assets/js/main.0f1b1348.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/quiri-docs/"><div class="navbar__logo"><img src="/quiri-docs/img/quiri_logo.svg" alt="Quiri Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/quiri-docs/img/quiri_logo.svg" alt="Quiri Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Quiri.dev</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/quiri-docs/">Docs</a><a class="navbar__item navbar__link" href="/quiri-docs/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/quiri-io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/quiri-docs/">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/quiri-docs/adding-fcm">Adding FCM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/quiri-docs/distributing-with-google-play-store">Distributing with Google Play Store</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/quiri-docs/server-management">Server Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/quiri-docs/whitelabelling-element-android">Whitelabelling Element Android</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/quiri-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Whitelabelling Element Android</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Whitelabelling Element Android</h1><h1>To fork or not to fork?</h1><ul><li>Forking allows for easier contributing back to element should that ever happen…</li><li>Pays respect generally to the fact that this is made from open source code</li><li>Might be easier to merge their changes in later?
So we fork it!</li><li>BUT actually forks cannot be made private soo maybe a manual mirror?<ul><li><a href="https://docs.github.com/en/repositories/creating-and-managing-repositories/duplicating-a-repository" target="_blank" rel="noopener noreferrer">https://docs.github.com/en/repositories/creating-and-managing-repositories/duplicating-a-repository</a></li><li><a href="http://blog.plataformatec.com.br/2013/05/how-to-properly-mirror-a-git-repository/" target="_blank" rel="noopener noreferrer">http://blog.plataformatec.com.br/2013/05/how-to-properly-mirror-a-git-repository/</a></li><li><a href="https://www.edwardthomson.com/blog/mirroring_git_repositories.html" target="_blank" rel="noopener noreferrer">https://www.edwardthomson.com/blog/mirroring_git_repositories.html</a>
Looks like the first thought actually made the most sense!</li></ul></li><li>Clone the element-android project locally under the name quiri-android</li><li><a href="https://www.freecodecamp.org/news/git-clone-branch-how-to-clone-a-specific-branch/" target="_blank" rel="noopener noreferrer">Only clone main as we only want to build upon releases</a><ul><li>git clone -b main --single-branch --no-tags <a href="mailto:git@github.com" target="_blank" rel="noopener noreferrer">git@github.com</a>:vector-im/element-android.git quiri-android</li><li>Rename the main branch to element/main</li><li>git branch -m element/main</li><li>Rename the element remote</li><li>git remote rename origin element-origin</li><li>Create a new main branch (will be the quiri-android main branch)</li><li>git checkout -b main</li><li>Create an empty repo on github called quiri-android</li><li>Add the new remote</li><li>git remote add origin <a href="mailto:git@github.com" target="_blank" rel="noopener noreferrer">git@github.com</a>:quiri-io/quiri-android.git</li><li>Push the new remote branch to origin</li><li>git push --set-upstream origin main</li><li>And also push the element/main branch</li><li>git checkout element/main</li><li>git push --set-upstream origin</li><li>And then set element/main to track the element-origin remote again</li><li>git branch element/main -u element-origin/main
Now we should lock down basically any way of modifying element/main<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- Looks like that is a pro feature… just have to be careful for now</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li></ul><p>All of the workflows were brought over with the code. They start failing and sending emails. <a href="https://docs.github.com/en/actions/managing-workflow-runs/disabling-and-enabling-a-workflow" target="_blank" rel="noopener noreferrer">They should be disabled until you figure out what they do/how to fix them.</a></p><h1>Running the project for the first time after forking</h1><p><a href="https://github.com/gradle/gradle/issues/9361" target="_blank" rel="noopener noreferrer">https://github.com/gradle/gradle/issues/9361</a>
I blindly selected the remove option. I should probably come back and understand this better in the future</p><p>Then run on Pixel 4a emulator
And it just runs!
Now to change the package name so that we can release to play store under a name that we own</p><p>Trying to rename the packages to io.quiri.app
Followed this post
Built but with some warnings that may have not been there previously…</p><h1>Back to librarifying vector</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="starting-steps">Starting steps<a class="hash-link" href="#starting-steps" title="Direct link to heading">​</a></h2><p>Read up on product flavours in libraries later
Can’t have google-services.json in library
Now getting error: <code>incompatible types: &lt;null&gt; cannot be converted to int @com.airbnb.epoxy.EpoxyModelClass(layout = null)</code>
Maybe also doesn’t work well in library modules…
<a href="https://github.com/airbnb/epoxy/issues/226" target="_blank" rel="noopener noreferrer">Github issue</a>
<a href="https://stackoverflow.com/questions/59843745/epoxymodels-are-not-working-in-feature-modules-library-projects-in-android" target="_blank" rel="noopener noreferrer">The jsonviewer library project uses the EpoxyModelClass and it uses the R2.layout strategy with no complaints…</a>
<a href="https://stackoverflow.com/a/59849994" target="_blank" rel="noopener noreferrer">Going to try this</a>
<a href="https://stackoverflow.com/questions/42205767/context-getpackagename-vs-buildconfig-application-id" target="_blank" rel="noopener noreferrer">Got issues with APPLICATION_ID, so I swapped it for LIBRARY_PACKAGE_NAME</a>
<a href="https://stackoverflow.com/a/43348982" target="_blank" rel="noopener noreferrer">Using FCM in a library module</a>
I just commented out apply plugin: <code>com.google.gms.google-services</code> in the gplay flavour
<a href="https://stackoverflow.com/questions/46482576/java-static-final-in-kotlin-const-val-initializer-should-be-a-constant-value" target="_blank" rel="noopener noreferrer">Const <code>val</code> initializer should be a constant value</a></p><h1>Creating the Quiri app module</h1><p>Loosely followed this
File &gt; New &gt; Module
Name it io.quiri.app
minSDK is 21 (see dependencies.gradle)
Should change the quiri manifest to read minSdk from the same file
Choose blank activity
When gradle tries to resolve, it has a problem with</p><p>Just remove those two lines. The IDE added them for some reason, don’t know why it broke gradle
build s fine as long as vector is not a dependency of quiri
Add vector as a dependency of quiri</p><p>Had to create the flavours in quiri as well</p><h1>Manifest Merging</h1><p>The quiri main./AndroidManifest.xml had these problems (merged manifest)</p><p>Clicking the suggested fixes removed the errors…
And then it builds and installs to emulated device!</p><h1>Hilt DI Errors</h1><p>BUT there is some issues with Hilt being used in a “feature module”</p><div class="language-2022-04-20 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-2022-04-20 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    Process: io.quiri.app, PID: 4409</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    java.lang.RuntimeException: Unable to instantiate application im.vector.app.VectorApplication: java.lang.ClassNotFoundException: Didn&#x27;t find class &quot;im.vector.app.VectorApplication&quot; on path: DexPathList[[zip file &quot;/data/app/~~HJX48J0ULpskvHJ8JQO44Q==/io.quiri.app-tcmSBf87Qu2FfwNszXOYZw==/base.apk&quot;],nativeLibraryDirectories=[/data/app/~~HJX48J0ULpskvHJ8JQO44Q==/io.quiri.app-tcmSBf87Qu2FfwNszXOYZw==/lib/x86, /data/app/~~HJX48J0ULpskvHJ8JQO44Q==/io.quiri.app-tcmSBf87Qu2FfwNszXOYZw==/base.apk!/lib/x86, /system/lib, /system_ext/lib]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.app.LoadedApk.makeApplication(LoadedApk.java:1244)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.app.ActivityThread.handleBindApplication(ActivityThread.java:6683)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.app.ActivityThread.access$1300(ActivityThread.java:237)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1913)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.os.Handler.dispatchMessage(Handler.java:106)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.os.Looper.loop(Looper.java:223)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.app.ActivityThread.main(ActivityThread.java:7656)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.lang.reflect.Method.invoke(Native Method)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:592)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:947)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Caused by: java.lang.ClassNotFoundException: Didn&#x27;t find class &quot;im.vector.app.VectorApplication&quot; on path: DexPathList[[zip file &quot;/data/app/~~HJX48J0ULpskvHJ8JQO44Q==/io.quiri.app-tcmSBf87Qu2FfwNszXOYZw==/base.apk&quot;],nativeLibraryDirectories=[/data/app/~~HJX48J0ULpskvHJ8JQO44Q==/io.quiri.app-tcmSBf87Qu2FfwNszXOYZw==/lib/x86, /data/app/~~HJX48J0ULpskvHJ8JQO44Q==/io.quiri.app-tcmSBf87Qu2FfwNszXOYZw==/base.apk!/lib/x86, /system/lib, /system_ext/lib]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:207)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.lang.ClassLoader.loadClass(ClassLoader.java:379)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.lang.ClassLoader.loadClass(ClassLoader.java:312)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.app.AppComponentFactory.instantiateApplication(AppComponentFactory.java:76)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at androidx.core.app.CoreComponentFactory.instantiateApplication(CoreComponentFactory.java:52)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.app.Instrumentation.newApplication(Instrumentation.java:1158)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.app.LoadedApk.makeApplication(LoadedApk.java:1236)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.app.ActivityThread.handleBindApplication(ActivityThread.java:6683) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.app.ActivityThread.access$1300(ActivityThread.java:237) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1913) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.os.Handler.dispatchMessage(Handler.java:106) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.os.Looper.loop(Looper.java:223) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at android.app.ActivityThread.main(ActivityThread.java:7656) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.lang.reflect.Method.invoke(Native Method) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:592) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:947) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Suppressed: java.lang.NoClassDefFoundError: Failed resolution of: Lim/vector/app/Hilt_VectorApplication;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.lang.VMClassLoader.findLoadedClass(Native Method)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.lang.ClassLoader.findLoadedClass(ClassLoader.java:738)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.lang.ClassLoader.loadClass(ClassLoader.java:363)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ... 14 more</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Caused by: java.lang.ClassNotFoundException: Didn&#x27;t find class &quot;im.vector.app.Hilt_VectorApplication&quot; on path: DexPathList[[zip file &quot;/data/app/~~HJX48J0ULpskvHJ8JQO44Q==/io.quiri.app-tcmSBf87Qu2FfwNszXOYZw==/base.apk&quot;],nativeLibraryDirectories=[/data/app/~~HJX48J0ULpskvHJ8JQO44Q==/io.quiri.app-tcmSBf87Qu2FfwNszXOYZw==/lib/x86, /data/app/~~HJX48J0ULpskvHJ8JQO44Q==/io.quiri.app-tcmSBf87Qu2FfwNszXOYZw==/base.apk!/lib/x86, /system/lib, /system_ext/lib]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:207)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.lang.ClassLoader.loadClass(ClassLoader.java:379)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.lang.ClassLoader.loadClass(ClassLoader.java:312)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ... 17 more</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Looks like there is specific way to use hilt in a feature module
Basic Hilt
<a href="https://developer.android.com/training/dependency-injection/hilt-android" target="_blank" rel="noopener noreferrer">https://developer.android.com/training/dependency-injection/hilt-android</a>
Hilt with “feature modules”
<a href="https://developer.android.com/training/dependency-injection/hilt-multi-module" target="_blank" rel="noopener noreferrer">https://developer.android.com/training/dependency-injection/hilt-multi-module</a>
Tried just following the instructions for Basic Hilt setup in the quiri gradle file
Had to do this for kotlin(“kapt”)
Aaand got some fresh errors related to kapt</p><p>I just needed to add hilt dependencies into the quiri gradle in the same way that they were added to the vector gradle</p><p>Weird layout-inflater issue
Before this problem I had a problem that seemed to do with the fact that quiri app had a layout xml with the same name as one in vector
Just removed the layout xml that was created with the project and its associated activity
<a href="https://stackoverflow.com/questions/58554751/java-lang-nullpointerexception-missing-required-view-with-id" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/58554751/java-lang-nullpointerexception-missing-required-view-with-id</a>
Then I get a very non-descript error about the layout inflater
This guy describes the problem in more details <a href="https://stackoverflow.com/a/44143105" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/a/44143105</a>
This guy talks about how to debug it <a href="https://stackoverflow.com/a/40112945" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/a/40112945</a></p><p>So I just add an “any java exception” breakpoint and then start adding conditions to skip common exceptions until I hit something interesting
<a href="https://www.jetbrains.com/help/idea/using-breakpoints.html#breakpoint_condition" target="_blank" rel="noopener noreferrer">https://www.jetbrains.com/help/idea/using-breakpoints.html#breakpoint_condition</a>
My condition:
!(this instanceof ErrnoException) &amp;&amp; !(this instanceof UnixException) &amp;&amp; !(this instanceof FileAlreadyExistsException) &amp;&amp; !(this instanceof ClassNotFoundException) &amp;&amp; !(this instanceof NoSuchFileException) &amp;&amp; !(this instanceof FileNotFoundException)
There was some stackoverflow that talked about appcompat being a part of the problem… I lost that one</p><p>Same for logintoucharea</p><p>SOLUTION
I just had to remove the application tag from the quiri AndroidManifest.xml
It is clear that I don’t understand what I am doing but at least it is building now. It will be interesting to see how I will actually start adding my own components while using their code…</p><h1>First attempt notes</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started">Getting Started<a class="hash-link" href="#getting-started" title="Direct link to heading">​</a></h2><ul><li>pulled the code</li><li>used &quot;import existing code&quot; to import the project</li><li>got a sync error<ul><li>something about sha256 hash maybe causing errors</li><li>chose the &quot;remove that setting&quot; option</li></ul></li><li>then build starts!<ul><li>This version of the Android Support plugin for IntelliJ IDEA (or Android Studio) cannot open this project, please retry with version 4.2 or newer.</li><li>upgraded android studio</li><li>opted to give more memory to android studio heap when prompted</li><li>I don&#x27;t recall if I installed JDK 1.8 previously but it seemed to be needed</li><li>had issues with running avd on my macbook. Running on device now instead</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="todo">TODO<a class="hash-link" href="#todo" title="Direct link to heading">​</a></h2><ul><li>change some code and debug something</li><li>change app config to connect to local<ul><li>org/matrix/android/sdk/api/Matrix.kt<ul><li>the configuration gets injected in here?</li><li>I need to learn more about android...</li></ul></li><li>this is the config class src/main/java/org/matrix/android/sdk/api/MatrixConfiguration.kt<ul><li>does it fetch values from a config file somewhere? I want to be able to set it to my local machine for dev<ul><li>and to the quiri server otherwise</li></ul></li></ul></li><li>I think this is the main place that it loads config from: src/main/java/im/vector/app/VectorApplication.kt<ul><li>for now I can just hardcode the integrationUrl into VectorApplciation?</li></ul></li><li>this is the thing that lods those URLs src/main/java/org/matrix/android/sdk/internal/session/integrationmanager/IntegrationManager.kt<ul><li>this is for the &quot;integration manager&quot; <a href="https://element.io/element-matrix-store" target="_blank" rel="noopener noreferrer">https://element.io/element-matrix-store</a>, NOT the chat server</li></ul></li><li>search for homeserver in the code yadoi</li></ul></li><li>how to connect to locally running matrix server from device<ul><li><a href="https://stackoverflow.com/questions/4779963/how-can-i-access-my-localhost-from-my-android-device" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/4779963/how-can-i-access-my-localhost-from-my-android-device</a></li></ul></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/quiri-docs/server-management"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Server Management</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#starting-steps" class="table-of-contents__link toc-highlight">Starting steps</a></li><li><a href="#getting-started" class="table-of-contents__link toc-highlight">Getting Started</a></li><li><a href="#todo" class="table-of-contents__link toc-highlight">TODO</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/quiri-docs/assets/js/runtime~main.10bef9fe.js"></script>
<script src="/quiri-docs/assets/js/main.0f1b1348.js"></script>
</body>
</html>